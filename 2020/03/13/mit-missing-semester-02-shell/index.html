<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="tool,bash,">





  <link rel="alternate" href="/atom.xml" title="来呀，快活呀~" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="工欲善其事，必先利其器。MIT Missing Semester就是这样一门课。在这门课中，不会讲到多少理论知识，也不会告诉你如何写代码，而是会向你介绍诸如shell，git等常用工具的使用。这些工具其实自己在学习工作中或多或少都有接触，不过还是有一些点是漏掉的。所以，一起来和MIT的这些牛人们重新熟悉下这些工具吧！ 这篇博客，包括后续的几篇，是我个人在过课程lecture的时候随手记下的自己之前">
<meta name="keywords" content="tool,bash">
<meta property="og:type" content="article">
<meta property="og:title" content="MIT Missing Semester - Shell">
<meta property="og:url" content="https://xmfbit.github.io/2020/03/13/mit-missing-semester-02-shell/index.html">
<meta property="og:site_name" content="来呀，快活呀~">
<meta property="og:description" content="工欲善其事，必先利其器。MIT Missing Semester就是这样一门课。在这门课中，不会讲到多少理论知识，也不会告诉你如何写代码，而是会向你介绍诸如shell，git等常用工具的使用。这些工具其实自己在学习工作中或多或少都有接触，不过还是有一些点是漏掉的。所以，一起来和MIT的这些牛人们重新熟悉下这些工具吧！ 这篇博客，包括后续的几篇，是我个人在过课程lecture的时候随手记下的自己之前">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-05-04T14:20:05.703Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MIT Missing Semester - Shell">
<meta name="twitter:description" content="工欲善其事，必先利其器。MIT Missing Semester就是这样一门课。在这门课中，不会讲到多少理论知识，也不会告诉你如何写代码，而是会向你介绍诸如shell，git等常用工具的使用。这些工具其实自己在学习工作中或多或少都有接触，不过还是有一些点是漏掉的。所以，一起来和MIT的这些牛人们重新熟悉下这些工具吧！ 这篇博客，包括后续的几篇，是我个人在过课程lecture的时候随手记下的自己之前">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://xmfbit.github.io/2020/03/13/mit-missing-semester-02-shell/">





  <title> MIT Missing Semester - Shell | 来呀，快活呀~ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-89140122-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">来呀，快活呀~</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle"></p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://xmfbit.github.io/2020/03/13/mit-missing-semester-02-shell/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="一个脱离了高级趣味的人">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/avatar/liumengli.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="来呀，快活呀~">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="来呀，快活呀~" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                MIT Missing Semester - Shell
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-13T22:05:30+00:00">
                2020-03-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>工欲善其事，必先利其器。<a href="https://missing.csail.mit.edu/" target="_blank" rel="noopener">MIT Missing Semester</a>就是这样一门课。在这门课中，不会讲到多少理论知识，也不会告诉你如何写代码，而是会向你介绍诸如shell，git等常用工具的使用。这些工具其实自己在学习工作中或多或少都有接触，不过还是有一些点是漏掉的。所以，一起来和MIT的这些牛人们重新熟悉下这些工具吧！</p>
<p>这篇博客，包括后续的几篇，是我个人在过课程lecture的时候随手记下的自己之前不太清楚的点，可能并不适合阅读到这篇文章的你。如果有时间，还是建议去课程网站上自己过一遍。</p>
<p>这里我跳过了第一节课，直接从bash shell开始。</p>
<a id="more"></a>
<h2 id="一些零散的点"><a href="#一些零散的点" class="headerlink" title="一些零散的点"></a>一些零散的点</h2><ul>
<li>bash中双引号和单引号的区别</li>
</ul>
<p>双引号会发生变量替换，单引号不会。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">foo=bar</span><br><span class="line"></span><br><span class="line"><span class="comment"># output: hello, bar</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello, <span class="variable">$foo</span>"</span></span><br><span class="line"><span class="comment"># output: hello, $foo</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'hello, $foo'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>bangbang</li>
</ul>
<p>使用<code>!!</code>可以执行上一条命令。</p>
<ul>
<li>bash 中的特殊变量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$? <span class="comment"># 上一条命令的返回值，正常退出是0，否则是非0</span></span><br><span class="line"><span class="variable">$@</span> <span class="comment"># 所有输入的参数</span></span><br><span class="line"><span class="variable">$#</span> <span class="comment"># 输入参数的个数</span></span><br><span class="line">$$ <span class="comment"># pid of current script</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查上条命令是否正常退出</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"fail"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"success"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<ul>
<li>如何忽略命令的输出</li>
</ul>
<p>有的时候，我们只想要命令的返回值。例如使用<code>grep foo bar</code>来查看文件<code>bar</code>中是否含有字符串<code>foo</code>，可以将标准输出和标准错误重定向到<code>/dev/null</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一个是标准输出，第二个是标准错误</span></span><br><span class="line">grep <span class="string">"foo"</span> bar &gt; /dev/null 2&gt; /dev/null</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者可以这样：</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># grep "name" test_lazy.cpp 2&gt;&amp;1 &gt; /dev/null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"$?"</span> -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"found foo in bar"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"not found foo in bar"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="globbing"><a href="#globbing" class="headerlink" title="globbing"></a>globbing</h2><ul>
<li>任意字符：<code>*</code></li>
<li>单个字符：<code>?</code></li>
<li>使用<code>{}</code>给定可选元素的集合。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a.&#123;hpp,cpp&#125;  =&gt; a.hpp a.cpp</span><br><span class="line">a&#123;,0,1,2&#125;   =&gt; a a0 a1 a2</span><br><span class="line"><span class="comment"># 支持多层级</span></span><br><span class="line">touch proj&#123;1,2&#125;/&#123;a,b&#125;.txt</span><br><span class="line"><span class="comment"># 还支持range</span></span><br><span class="line">touch proj&#123;1,2&#125;/&#123;a..g&#125;.txt</span><br></pre></td></tr></table></figure>
<h2 id="bash-中的函数"><a href="#bash-中的函数" class="headerlink" title="bash 中的函数"></a>bash 中的函数</h2><ul>
<li>如何写函数</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">mycd</span></span> () &#123;</span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$1</span></span><br><span class="line">    <span class="built_in">pwd</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如何在bash中导入脚本中的函数</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> your_bash_script.sh</span><br><span class="line"><span class="comment"># then use the function defined in the bash script</span></span><br><span class="line"><span class="comment"># 你可以这样理解：from your_bash_script import *</span></span><br></pre></td></tr></table></figure>
<h2 id="for-loop"><a href="#for-loop" class="headerlink" title="for-loop"></a>for-loop</h2><h3 id="遍历给定的元素序列"><a href="#遍历给定的元素序列" class="headerlink" title="遍历给定的元素序列"></a>遍历给定的元素序列</h3><p>使用<code>for item in xxx; do yyy; done</code>来遍历给定的序列，并施加具体操作于序列元素：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> 1 2 3</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"welcome <span class="variable">$i</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># welcome 1</span></span><br><span class="line"><span class="comment"># welcome 2</span></span><br><span class="line"><span class="comment"># welcome 3</span></span><br></pre></td></tr></table></figure>
<p>注意，列表元素是通过空格来隔离的。如果这样写</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> 1, 2, 3</span><br></pre></td></tr></table></figure>
<p>那么最终输出也是<code>welcome 1, welcome 2, welcome 3</code></p>
<p>还可以使用for-range的方法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..3&#125;</span><br></pre></td></tr></table></figure>
<h3 id="c-style-for-loop"><a href="#c-style-for-loop" class="headerlink" title="c-style for-loop"></a>c-style for-loop</h3><p>也可以像C语言那样使用for-loop：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (( Exp1; Exp2; Exp3)); <span class="keyword">do</span> xxx; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (( c=1; c&lt;=3; c++ )); <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">"welcome <span class="variable">$c</span>"</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>还可以使用这种风格构造无穷循环，<code>for (( ; ; )); do xxx; done</code>。</p>
<h3 id="break-continue"><a href="#break-continue" class="headerlink" title="break / continue"></a>break / continue</h3><p>当满足一定条件时，使用<code>break</code>退出循环，或使用<code>continue</code>继续循环。</p>
<h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><p>除了for-loop，还可以使用<code>while</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> CONDITION; <span class="keyword">do</span> xxx; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="until"><a href="#until" class="headerlink" title="until"></a>until</h3><p><code>until</code>和<code>while</code>的用法一致，不同点在于：</p>
<ul>
<li><code>while</code>是CONDITION为<code>true</code>执行，当<code>false</code>是退出循环</li>
<li><code>until</code>是CONDITION为<code>false</code>执行，当<code>true</code>时退出循环</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c=1</span><br><span class="line">until [ <span class="variable">$c</span> -gt 3 ]; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"welcome <span class="variable">$c</span>"</span></span><br><span class="line">  ((c++))</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="数学表达式"><a href="#数学表达式" class="headerlink" title="数学表达式"></a>数学表达式</h2><p>在上面for-loop中，已经看到了我们使用<code>((exp))</code>的形式进行数学表达式运算。一般来说，在bash shell中进行数学表达式的运算可以采用：</p>
<ul>
<li>使用<code>expr</code>，如<code>c=$(expr 1 + 1); echo $c</code>，注意操作数与操作符之间都是有空格的。</li>
<li>使用<code>let</code>，如<code>c=1; let c=$c+1; echo $c</code>，注意操作数与操作符之间没有空格。</li>
<li>使用双括号<code>(())</code>，就像上面看到的那样：<code>c=1; echo $((c += 1)); echo $c</code>。这时候，操作数与操作符之间的空格可有可无。</li>
</ul>
<p>最后一种双括号可能更为常用，支持的操作符：<code>+/-/++/--/*/%/**</code>，也支持逻辑运算符：<code>&gt;=/&lt;=/&gt;/&lt;/==/!=/!/||/&amp;&amp;</code>。</p>
<p>如果希望进行浮点数运算，bash本身是不支持的，可以使用<code>bc</code>命令，将表达式作为字符串传入就可以了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"1.0+2.0"</span> | bc</span><br><span class="line">c=$(r=1.5;<span class="built_in">echo</span> <span class="string">"<span class="variable">$r</span> + 2.5"</span>|bc); <span class="built_in">echo</span> <span class="variable">$c</span></span><br></pre></td></tr></table></figure>
<h2 id="调试工具"><a href="#调试工具" class="headerlink" title="调试工具"></a>调试工具</h2><p>shellcheck可以用来帮助静态分析shell脚本。用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shellcheck your_bash_script.sh</span><br></pre></td></tr></table></figure>
<p>可以去网站上试用：<a href="https://www.shellcheck.net/#" target="_blank" rel="noopener">Shellcheck</a></p>
<h2 id="几个有用的命令"><a href="#几个有用的命令" class="headerlink" title="几个有用的命令"></a>几个有用的命令</h2><p>这里列出一些常用的命令工具，都是和查找有关。更多内容，可以通过<code>man</code>或者<code>tldr</code>查看。</p>
<h3 id="查找文件-find"><a href="#查找文件-find" class="headerlink" title="查找文件 find"></a>查找文件 find</h3><p>最常用的用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 递归地查找当前目录及子目录下所有的python文件</span></span><br><span class="line">find . -name=<span class="string">"*.py"</span></span><br><span class="line"><span class="comment"># -type d 表示过滤结果为所有目录</span></span><br><span class="line"><span class="comment"># -type f 表示过滤结果为所有文件</span></span><br><span class="line">find . -name=<span class="string">"test"</span> -<span class="built_in">type</span> d</span><br><span class="line"><span class="comment"># Find all files modified in the last day</span></span><br><span class="line">find . -mtime -1</span><br><span class="line"><span class="comment"># Find all zip files with size in range 500k to 10M</span></span><br><span class="line">find . -size +500k -size -10M -name <span class="string">'*.tar.gz'</span></span><br></pre></td></tr></table></figure>
<p><code>find</code>还可以通过<code>-exec</code>来接后续处理，如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Delete all files with .tmp extension</span></span><br><span class="line"><span class="comment"># 注意最后的 \</span></span><br><span class="line">find . -name <span class="string">'*.tmp'</span> -<span class="built_in">exec</span> rm &#123;&#125; \;</span><br><span class="line"><span class="comment"># Find all PNG files and convert them to JPG</span></span><br><span class="line">find . -name <span class="string">'*.png'</span> -<span class="built_in">exec</span> convert &#123;&#125; &#123;.&#125;.jpg \;</span><br></pre></td></tr></table></figure>
<p>你也可以用<code>fd</code>作为<code>find</code>的改进版。具体用法可以参考<a href="https://github.com/sharkdp/fd" target="_blank" rel="noopener">fd</a>，这里不再多说了。</p>
<h3 id="locate"><a href="#locate" class="headerlink" title="locate"></a>locate</h3><p>如果你想按照名字去查找文件，还可以试试<code>locate</code>。一个简单的比较：</p>
<ul>
<li><code>locate</code>只支持按名字查找，<code>find</code>可以更加多样</li>
<li><code>locate</code>通过周期性更新的database来查找，时效性不如<code>find</code></li>
<li><code>locate</code>使用更简单，默认会查找所有符合要求的文件，<code>find</code>一般是查找给定路径下的文件</li>
</ul>
<p>由于上述原因，我一般是使用<code>locate</code>查找系统自带的某个lib等文件。比如有时候我可能不知道<code>libcudart.so</code>在哪里，这时候就可以通过<code>locate libcudart.so</code>来查找。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">locate libcudart.so | grep <span class="string">"/usr"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># output:</span></span><br><span class="line"><span class="comment"># /usr/local/cuda-10.0/doc/man/man7/libcudart.so.7</span></span><br><span class="line"><span class="comment"># /usr/local/cuda-10.0/lib64/libcudart.so</span></span><br><span class="line"><span class="comment"># ...</span></span><br></pre></td></tr></table></figure>
<h3 id="在文件中查找字符串-grep"><a href="#在文件中查找字符串-grep" class="headerlink" title="在文件中查找字符串 grep"></a>在文件中查找字符串 grep</h3><p><code>grep</code> 用来在文件中正则匹配字符串，比如某个变量或函数定义啥的。<code>grep</code>命令很有用，在后续课程中还会着重介绍。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在文件中查找xxx，并打印其所在的行</span></span><br><span class="line">grep xxx file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在所有文件中递归地查找</span></span><br><span class="line">grep -R xxx .</span><br></pre></td></tr></table></figure>
<p>常用的一些flag，可以是<code>-C +number</code>（用来显示match的context，number是行数），<code>-v</code>是反转（不包含所给pattern的行）</p>
<p>和<code>find</code>一样，<code>grep</code>也有一些更好用的替代品，如<code>rg</code>，<code>ag</code>，<code>ack</code>等。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Find all python files where I used the requests library</span></span><br><span class="line">rg -t py <span class="string">'import requests'</span></span><br><span class="line"><span class="comment"># Find all files (including hidden files) without a shebang line</span></span><br><span class="line">rg -u --files-without-match <span class="string">"^#!"</span></span><br><span class="line"><span class="comment"># Find all matches of foo and print the following 5 lines</span></span><br><span class="line">rg foo -A 5</span><br><span class="line"><span class="comment"># Print statistics of matches (# of matched lines and files )</span></span><br><span class="line">rg --stats PATTERN</span><br></pre></td></tr></table></figure>
<h3 id="查找历史命令-history"><a href="#查找历史命令-history" class="headerlink" title="查找历史命令 history"></a>查找历史命令 history</h3><p><code>history</code>可以打印历史的shell命令，和<code>grep</code>配合能够找到历史上曾经用过的某给定命令。不过这个我在使用<code>zsh</code>的时候，一般是通过光标上下键来联想查找的。</p>
<p>一个有用的工具：<code>fzf</code>（which means 模糊查找）。</p>
<p>另外，这里讲师推荐了一款基于历史命令的自动补全（看lecture时候觉得很酷）。如果你和我一样使用<code>zsh</code>，可以参考这个插件：<a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="noopener">zsh-autosuggestions</a>。</p>
<h3 id="关于目录"><a href="#关于目录" class="headerlink" title="关于目录"></a>关于目录</h3><p>因为shell环境下没有GUI，所以查看一个目录内的内容，包括跳转目录都很不方便。对此也有一些好用的工具：</p>
<ul>
<li>查看目录内容：<code>tree</code>（最经典），<code>broot</code>，<code>nnn</code>，<code>ranger</code></li>
<li>跳转目录：<code>autojump</code>（在用），<code>fasd</code></li>
</ul>
<h2 id="课后习题"><a href="#课后习题" class="headerlink" title="课后习题"></a>课后习题</h2><h3 id="关于ls的用法"><a href="#关于ls的用法" class="headerlink" title="关于ls的用法"></a>关于ls的用法</h3><ul>
<li>Includes all files, including hidden files：<code>ls -al</code></li>
<li>Sizes are listed in human readable format (e.g. 454M instead of 454279954)：<code>ls -lh</code></li>
<li>Files are ordered by recency：<code>ls -lt</code></li>
<li>Output is colorized：<code>ls -l --color</code> （zsh自动colorized，所以这个没有验证）</li>
</ul>
<h3 id="bash函数"><a href="#bash函数" class="headerlink" title="bash函数"></a>bash函数</h3><p>Write bash functions <code>marco</code> and <code>polo</code> that do the following. Whenever you execute <code>marco</code> the current working directory should be saved in some manner, then when you execute <code>polo</code>, no matter what directory you are in, <code>polo</code> should cd you back to the directory where you executed <code>marco</code>. For ease of debugging you can write the code in a file <code>marco.sh</code> and (re)load the definitions to your shell by executing <code>source marco.sh</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用文件存储要cd的path</span></span><br><span class="line"><span class="function"><span class="title">macro</span></span> () &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$(pwd)</span>"</span> &gt; <span class="variable">$HOME</span>/.macro.history</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">polo</span></span> () &#123;</span><br><span class="line">    <span class="built_in">cd</span> <span class="string">"<span class="variable">$(cat "$HOME/.macro.history")</span>"</span> || <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="循环和程序返回值判断"><a href="#循环和程序返回值判断" class="headerlink" title="循环和程序返回值判断"></a>循环和程序返回值判断</h3><p>Say you have a command that fails rarely. In order to debug it you need to capture its output but it can be time consuming to get a failure run. Write a bash script that runs the following script until it fails and captures its standard output and error streams to files and prints everything at the end. Bonus points if you can also report how many runs it took for the script to fail.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ((i=1; ; i++)); <span class="keyword">do</span></span><br><span class="line">  <span class="comment"># save the script to `fail_rarely.sh`</span></span><br><span class="line">  ./fail_rarely.sh 2&amp;&gt; out.log</span><br><span class="line">  <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"fail after run <span class="variable">$i</span> times"</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"stdout and stderr message:"</span></span><br><span class="line">    cat out.log</span><br><span class="line">    <span class="built_in">break</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="xargs和管道"><a href="#xargs和管道" class="headerlink" title="xargs和管道"></a>xargs和管道</h3><p>As we covered in lecture find’s <code>-exec</code> can be very powerful for performing operations over the files we are searching for. However, what if we want to do something with all the files, like creating a zip file? As you have seen so far commands will take input from both arguments and STDIN. When piping commands, we are connecting STDOUT to STDIN, but some commands like tar take inputs from arguments. To bridge this disconnect there’s the <code>xargs</code> command which will execute a command using STDIN as arguments. For example <code>ls | xargs rm</code> will delete the files in the current directory.</p>
<p>Your task is to write a command that recursively finds all HTML files in the folder and makes a zip with them. Note that your command should work even if the files have spaces (hint: check <code>-d</code> flag for <code>xargs</code>)</p>
<h4 id="xargs"><a href="#xargs" class="headerlink" title="xargs"></a>xargs</h4><p>先来看下<code>xargs</code>和管道的区别。这里已经给了一个例子：<code>ls | xargs rm</code>。由于<code>rm</code>命令比较危险，所以下面会换成<code>cat</code>（删除文件变成了打印文件内容）。</p>
<p>为什么不能用管道呢，比如<code>ls | cat</code>。我们先建立一个空目录作为playground：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="built_in">test</span></span><br><span class="line"><span class="built_in">cd</span> <span class="built_in">test</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"simgple test"</span> &gt; a.txt</span><br></pre></td></tr></table></figure>
<p>执行<code>ls | cat</code>，会发现它只是把当前目录下的所有文件名打印了出来，并没有打印<code>a.txt</code>的内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls | cat</span><br><span class="line"><span class="comment"># a.txt</span></span><br></pre></td></tr></table></figure>
<p>这是因为管道只是把STDOUT作为<code>cat</code>的STDIN。在linux中，STDOUT和STDIN是两个特殊的文件，<code>ls</code>将把它的输出结果写入到STDOUT中，同时我们就会在屏幕上看到对应输出。而<code>cat</code>从STDIN中接受输入。当没有管道时，由用户输入并写入STDIN。由于管道，<code>cat</code>将直接从STDOUT中读取。也就是<code>ls</code>的输出，也就是当前目录下的文件列表。拆解后想当于下面：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls &gt; stdout_ls</span><br><span class="line">cat &lt; stdout_ls</span><br></pre></td></tr></table></figure>
<p>所以，如果我们想要打印<code>a.txt</code>的内容，管道就不够用了。也就是上面说的，我们要把<code>ls</code>的输出作为<code>cat</code>的参数。这时候需要使用<code>xargs</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls | xargs cat</span><br><span class="line"><span class="comment"># simple test</span></span><br></pre></td></tr></table></figure>
<h4 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h4><p>先准备一些测试文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir htmls</span><br><span class="line"><span class="built_in">cd</span> htmls</span><br><span class="line">mkdir htmls/&#123;1..3&#125;</span><br><span class="line">touch htmls/1/1.html</span><br><span class="line">touch htmls/2/2\ 2.html</span><br><span class="line">touch htmls/root.html</span><br></pre></td></tr></table></figure>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p>题目说明中的<code>-d</code>没找到，在<a href="https://www.tecmint.com/xargs-command-examples/" target="_blank" rel="noopener">12 Practical Examples of Linux Xargs Command for Beginners</a>找到了如下用法，使用<br><code>-print0</code>和<code>-0</code>（是数字<code>0</code>）配合，具体可以参考<code>man xargs</code>中的内容。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-0      Change xargs to expect NUL (``\0'') characters as separators, instead of spaces and newlines.  </span></span><br><span class="line"><span class="comment">#        This is expected to be used in concert with the -print0 function in find(1).</span></span><br><span class="line"></span><br><span class="line">find htmls -name <span class="string">"*.html"</span> -print0 | xargs -0 tar vcf html.zip</span><br></pre></td></tr></table></figure>
<h3 id="命令组合"><a href="#命令组合" class="headerlink" title="命令组合"></a>命令组合</h3><p>Write a command or script to recursively find the most recently modified file in a directory. More generally, can you list all files by recency?</p>
<p>首先递归地列出当前目录下的所有文件，再使用<code>ls -lt</code>将其按照时间排序。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find -L . -<span class="built_in">type</span> f -print0 | xargs -0 ls -lt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果只需要最新的那个，使用 head命令只打印第一行</span></span><br><span class="line">find -L . -<span class="built_in">type</span> f -print0 | xargs -0 ls -lt | head -1</span><br></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/tool/" rel="tag"># tool</a>
          
            <a href="/tags/bash/" rel="tag"># bash</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/24/caffe-compiling-debian9/" rel="next" title="Debian9 编译Caffe的一个坑">
                <i class="fa fa-chevron-left"></i> Debian9 编译Caffe的一个坑
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/03/15/mit-missing-semester-04-data-wrangling/" rel="prev" title="MIT Missing Semester - Data Wrangling">
                MIT Missing Semester - Data Wrangling <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
        <div id="lv-container" data-id="city" data-uid="MTAyMC8yODMwOS80ODgx"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/avatar/liumengli.jpg" alt="一个脱离了高级趣味的人">
          <p class="site-author-name" itemprop="name">一个脱离了高级趣味的人</p>
          <p class="site-description motion-element" itemprop="description">相与枕藉乎舟中，不知东方之既白</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">89</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">34</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/xmfbit" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/2629935075/" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一些零散的点"><span class="nav-number">1.</span> <span class="nav-text">一些零散的点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#globbing"><span class="nav-number">2.</span> <span class="nav-text">globbing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bash-中的函数"><span class="nav-number">3.</span> <span class="nav-text">bash 中的函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#for-loop"><span class="nav-number">4.</span> <span class="nav-text">for-loop</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#遍历给定的元素序列"><span class="nav-number">4.1.</span> <span class="nav-text">遍历给定的元素序列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-style-for-loop"><span class="nav-number">4.2.</span> <span class="nav-text">c-style for-loop</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#break-continue"><span class="nav-number">4.3.</span> <span class="nav-text">break / continue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#while"><span class="nav-number">4.4.</span> <span class="nav-text">while</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#until"><span class="nav-number">4.5.</span> <span class="nav-text">until</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数学表达式"><span class="nav-number">5.</span> <span class="nav-text">数学表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#调试工具"><span class="nav-number">6.</span> <span class="nav-text">调试工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#几个有用的命令"><span class="nav-number">7.</span> <span class="nav-text">几个有用的命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查找文件-find"><span class="nav-number">7.1.</span> <span class="nav-text">查找文件 find</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#locate"><span class="nav-number">7.2.</span> <span class="nav-text">locate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在文件中查找字符串-grep"><span class="nav-number">7.3.</span> <span class="nav-text">在文件中查找字符串 grep</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查找历史命令-history"><span class="nav-number">7.4.</span> <span class="nav-text">查找历史命令 history</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于目录"><span class="nav-number">7.5.</span> <span class="nav-text">关于目录</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#课后习题"><span class="nav-number">8.</span> <span class="nav-text">课后习题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#关于ls的用法"><span class="nav-number">8.1.</span> <span class="nav-text">关于ls的用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bash函数"><span class="nav-number">8.2.</span> <span class="nav-text">bash函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#循环和程序返回值判断"><span class="nav-number">8.3.</span> <span class="nav-text">循环和程序返回值判断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xargs和管道"><span class="nav-number">8.4.</span> <span class="nav-text">xargs和管道</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#xargs"><span class="nav-number">8.4.1.</span> <span class="nav-text">xargs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#准备"><span class="nav-number">8.4.2.</span> <span class="nav-text">准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实现"><span class="nav-number">8.4.3.</span> <span class="nav-text">实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#命令组合"><span class="nav-number">8.5.</span> <span class="nav-text">命令组合</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">一个脱离了高级趣味的人</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



    
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  





  




	





  





  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid="></script>
      <!-- UY END -->
  




  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  


</body>
</html>
